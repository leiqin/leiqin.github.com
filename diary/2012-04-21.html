<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <link rel="shortcut icon" href="../images/galaxy-ngc3370.jpg" type="image/jpeg" />
        <link rel="Stylesheet" type="text/css" href="../css/default.css" />
        <title>从源码安装 wine -- 雷钦的博客</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    </head>
    <body>
        <div id="container">
            <div id="header">
                <h1 id="header-title">我自求我道，各自求各道</h1>
            </div>
            <div id="content">
                <h1 class="justcenter">从源码安装 wine</h1>
                

<p>
最近想玩一下 <a href="http://www.winehq.org">wine</a> ，在 linux 里运行一些 windows 的软件，最初的需求是为了解决 windows 下的 zip 包 中文文件名乱码的问题，感觉为了这么一点小事就开个虚拟机太蛋疼了，也没有找到 linux 下的原生解决方案，开个新终端，生成 <code>zh_CN.GB18030</code> 的 <code>locale</code> ，然后设置 <code>LANG=zh_CN.GB18030</code> 和 <code>LC_ALL=zh_CN.GB18030</code> 用 unzip 命令解压，结果是... 该是乱码的还是乱码。
</p>

<p>
wine 在 debian sid 源中的版本太低，只有 1.0 ，而 wine-unstable 的版本只有 1.1 ，而实际上 wine 的稳定版已经到了 1.4 ，而开发版已经到了 1.5 ，我决定从<a href="http://wiki.winehq.org/GitWine">源码安装 wine</a> 。 
</p>

<p>
首先下载源码：
</p>

<pre>
git clone git://source.winehq.org/git/wine.git ~/wine-git
cd ~/wine-git
</pre>

<p>
然后<a href="http://www.winehq.org/site/docs/wineusr-guide/installing-wine-source">安装 wine</a>：
</p>

<pre>
./configure
make depend
make
make install
</pre>

<p>
可以根据 <code>./configuare</code> 的输出，来安装依赖关系，也可以参考 <a href="http://wiki.winehq.org/Recommended_Packages">wine 的 wiki</a>。
</p>

<p>
如果没有出错的话，就安装成功了。接下来，就是要解决中文乱码的问题，这里我并没有找到一个非常好的方法，不过至少找到一个可用的方法。
</p>

<p>
首先执行：
</p>

<pre>
winecfg
</pre>

<p>
如果 LANG 是中文的话，这时应该显示的是乱码，不要紧，等会就不是了。它会在 <code>~/.wine</code> 下生成一些文件，我们就是要修改这写文件。
</p>

<p>
编辑 <code>~/.wine/system.reg</code> ，搜索 <code>CurrentVersion\\Fonts</code> 把它下面指定字体文件的地址全部换成<a href="http://wenq.org/">文泉驿</a>微米黑的字体文件
</p>

<pre>
"Courier"="Z:\\path\\to\\wqy-microhei.ttc"
"Marlett (TrueType)"="Z:\\path\\to\\wqy-microhei.ttc"
"MS Sans Serif"="Z:\\path\\to\\wqy-microhei.ttc"
"MS Serif"="Z:\\path\\to\\wqy-microhei.ttc"
"Small Fonts"="Z:\\path\\to\\wqy-microhei.ttc"
"Symbol (TrueType)"="Z:\\path\\to\\wqy-microhei.ttc"
"Tahoma (TrueType)"="Z:\\path\\to\\wqy-microhei.ttc"
"Tahoma Bold (TrueType)"="Z:\\path\\to\\wqy-microhei.ttc"
</pre>

<p>
这里有两个地方，一个是 <code>Windows</code> 还有一个是 <code>Windows NT</code> ，保存退出，再运行 <code>winecfg</code> 就可以看见亲切的中文了。
</p>

<p>
我安装的程序 <a href="http://www.7-zip.org/">7z</a> 在安装和使用时都没有乱码。 <a href="http://www.radmin.cn/">radmin</a> 的客户端，在安装过程中有乱码，使用时没有乱码。总之，已经不影响使用了。
</p>

            </div>
        </div>
    </body>
</html>
